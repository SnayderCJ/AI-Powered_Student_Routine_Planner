   {% extends 'base.html' %}
   {% load static %}

   {% block content %}
   <script src="{% static 'js/dashboard.js' %}"></script>
   <!-- Acciones rápidas -->
   
      <section class="quick-actions">
         <div class="quick-actions-header">
         <h2>Acciones rápidas</h2>
         <p>Accede a las funciones más utilizadas</p>
         </div>
         <div class="quick-actions-buttons">
         <button class="action-button">
            <i class="fas fa-plus-circle"></i>
            <div>
               <span>Nueva tarea</span>
               <span class="action-description">Añadir tarea pendiente</span>
            </div>
         </button>
         <button class="action-button">
            <i class="fas fa-calendar-plus"></i>
            <div>
               <span>Evento</span>
               <span class="action-description">Programar en calendario</span>
            </div>
         </button>
         <button class="action-button">
            <i class="fas fa-clock"></i>
            <div>
               <span>Pomodoro</span>
               <span class="action-description">Iniciar sesión de estudio</span>
            </div>
         </button>
         <button class="action-button">
            <i class="fas fa-list-ul"></i>
            <div>
               <span>Planificar</span>
               <span class="action-description">Organizar semana</span>
            </div>
         </button>
         </div>
      </section>

      <!-- Widgets principales -->
      <div class="dashboard-grid">
         <div class="main-column">
         <!-- Espacio de trabajo -->
         <section class="workspace-card">
            <div class="card-header">
               <h2>Mi espacio de trabajo</h2>
               <p>Gestiona tus tareas y horario académico</p>
            </div>
            <div class="workspace-tabs">
               <div class="tabs">
               <button class="tab active" data-tab="tasks">Tareas</button>
               <button class="tab" data-tab="calendar">Calendario</button>
               </div>
               <div class="tab-content active" id="tasksTab">
               <div class="kanban-board">
                  <div class="kanban-column">
                     <div class="column-header">
                     <h3>Pendientes</h3>
                     <span class="badge">{{ pending_count }}</span>
                     </div>
                     {% for task in pending_tasks %}
                     <div class="task-card" data-task-id="{{ task.id }}" style="cursor: pointer;">
                        <div class="task-header">
                           <h4>{{ task.title }}</h4>
                           <button class="task-menu"><i class="fas fa-ellipsis-h"></i></button>
                        </div>
                        <div class="task-due-date">
                           <i class="fas fa-clock"></i>
                           <span>{{ task.start_time|date:"H:i" }}</span>
                        </div>
                        <div class="task-tags">
                           <span class="tag subject-tag">{{ task.event_type }}</span>
                           <span class="tag priority-{{ task.priority }}">{{ task.priority }}</span>
                        </div>
                     </div>
                     {% endfor %}
                  </div>
                  <div class="kanban-column">
                     <div class="column-header">
                     <h3>Completadas</h3>
                     <span class="badge">{{ completed_count }}</span>
                     </div>
                     {% for task in completed_tasks %}
                     <div class="task-card completed" data-task-id="{{ task.id }}" style="cursor: pointer;">
                        <div class="task-header">
                           <h4>{{ task.title }}</h4>
                           <button class="task-menu"><i class="fas fa-ellipsis-h"></i></button>
                        </div>
                        <div class="task-due-date">
                           <i class="fas fa-clock"></i>
                           <span>Completada</span>
                        </div>
                        <div class="task-tags">
                           <span class="tag subject-tag">{{ task.event_type }}</span>
                           <span class="tag priority-{{ task.priority }}">{{ task.priority }}</span>
                        </div>
                     </div>
                     {% endfor %}
                  </div>
               </div>
               
               </div>
               {% csrf_token %}
               <div class="tab-content" id="calendarTab">
               <div class="calendar-view">
                  <div class="calendar-header">
                     <h3>Mayo 2025</h3>
                     <div class="calendar-navigation">
                     <button class="icon-button"><i class="fas fa-chevron-left"></i></button>
                     <button class="icon-button"><i class="fas fa-chevron-right"></i></button>
                     </div>
                  </div>
                  <div class="calendar-grid">
                     <div class="calendar-day-header">Hora</div>
                     <div class="calendar-day-header">Lunes</div>
                     <div class="calendar-day-header">Martes</div>
                     <div class="calendar-day-header">Miércoles</div>
                     <div class="calendar-day-header">Jueves</div>
                     <div class="calendar-day-header">Viernes</div>
                     <div class="calendar-day-header">Sábado</div>
                     <div class="calendar-day-header">Domingo</div>
                     
                     <!-- Filas de horas (simplificado) -->
                     <div class="calendar-hour">8:00</div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     
                     <div class="calendar-hour">9:00</div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell">
                     <div class="calendar-event physics">
                        <div>Física</div>
                        <div class="event-location">Lab 3</div>
                     </div>
                     </div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     
                     <div class="calendar-hour">10:00</div>
                     <div class="calendar-cell">
                     <div class="calendar-event math">
                        <div>Matemáticas</div>
                        <div class="event-location">Aula 201</div>
                     </div>
                     </div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     
                     <div class="calendar-hour">11:00</div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell">
                     <div class="calendar-event project">
                        <div>Proyecto Grupal</div>
                        <div class="event-location">Sala de Estudio</div>
                     </div>
                     </div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     
                     <div class="calendar-hour">12:00</div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     
                     <div class="calendar-hour">13:00</div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell">
                     <div class="calendar-event programming">
                        <div>Programación</div>
                        <div class="event-location">Sala de Informática</div>
                     </div>
                     </div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     
                     <div class="calendar-hour">14:00</div>
                     <div class="calendar-cell">
                     <div class="calendar-event study">
                        <div>Estudio</div>
                        <div class="event-location">Biblioteca</div>
                     </div>
                     </div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                     <div class="calendar-cell"></div>
                  </div>
               </div>
               </div>
            </div>
         </section>

         <!-- Vista semanal -->
         <section class="weekly-overview">
            <div class="card-header">
               <h2>Vista Semanal</h2>
            </div>
            <div class="weekly-grid">
               {% for day_index in "0123456" %}
               <div class="weekly-day">
                  <div class="day-header">
                     {% if day_index == "0" %}Lun
                     {% elif day_index == "1" %}Mar
                     {% elif day_index == "2" %}Mié
                     {% elif day_index == "3" %}Jue
                     {% elif day_index == "4" %}Vie
                     {% elif day_index == "5" %}Sáb
                     {% elif day_index == "6" %}Dom
                     {% endif %}
                  </div>
                  <div class="day-events">
                     {% for task in pending_tasks %}
                        {% if task.start_time.weekday|stringformat:"s" == day_index %}
                        <div class="week-event {% if task.event_type == 'class' %}class-event{% elif task.event_type == 'study' %}study-event{% elif task.event_type == 'meeting' %}meeting-event{% elif task.event_type == 'exam' %}exam-event{% elif task.event_type == 'deadline' %}deadline-event{% else %}task-event{% endif %}">
                           <div>{{ task.title }}</div>
                           <div>{{ task.start_time|date:"H:i" }} - {{ task.end_time|date:"H:i" }}</div>
                        </div>
                        {% endif %}
                     {% endfor %}
                     {% for task in completed_tasks %}
                        {% if task.start_time.weekday|stringformat:"s" == day_index %}
                        <div class="week-event completed-event">
                           <div>{{ task.title }}</div>
                           <div>{{ task.start_time|date:"H:i" }} - {{ task.end_time|date:"H:i" }}</div>
                        </div>
                        {% endif %}
                     {% endfor %}
                     {% if not pending_tasks and not completed_tasks %}
                        {% if day_index == "0" %}
                        <div class="week-event no-events">
                           <div>Sin eventos</div>
                        </div>
                        {% endif %}
                     {% endif %}
                  </div>
               </div>
               {% endfor %}
            </div>
         </section>
         </div>

         <div class="side-column">
         <!-- Modo Pomodoro -->
         <section class="focus-mode">
            <div class="card-header">
               <h2>Modo Pomodoro: Concentración</h2>
            </div>
            <div class="focus-content">
               <div class="timer">25:00</div>
               <div class="progress-bar">
               <div class="progress" style="width: 0%"></div>
               </div>
               <div class="timer-controls">
               <button class="timer-button reset-button">
                  <i class="fas fa-undo"></i>
                  Reiniciar
               </button>
               <button class="timer-button start-button">
                  <i class="fas fa-play"></i>
                  Iniciar
               </button>
               </div>
            </div>
         </section>

         <!-- Próximas entregas -->
         <section class="upcoming-deadlines">
            <div class="card-header">
               <h2>Próximas entregas</h2>
            </div>
            <div class="deadlines-list">
               {% for task in upcoming_tasks %}
               <div class="deadline-item">
                  <div class="deadline-icon">
                     <i class="fas fa-calendar-day"></i>
                  </div>
                  <div class="deadline-content">
                     <div class="deadline-header">
                        <h3>{{ task.title }}</h3>
                        <span class="tag priority-{{ task.priority }}">{{ task.priority }}</span>
                     </div>
                     <div class="deadline-details">
                        <span>{{ task.start_time|date:"l, j \d\e F \a \l\a\s H:i" }}</span>
                        <span class="tag subject-tag">{{ task.event_type }}</span>
                     </div>
                  </div>
               </div>
               {% empty %}
               <div class="deadline-item">
                  <div class="deadline-content">
                     <p style="text-align: center; color: #888; padding: 20px;">
                        No tienes próximas entregas pendientes
                     </p>
                  </div>
               </div>
               {% endfor %}
            </div>
         </section>

         <!-- Análisis de Productividad -->
         <section class="productivity-insights">
            <div class="card-header">
               <h2>Análisis de Productividad</h2>
            </div>
            <div class="chart-container">
               <div class="chart">
               <div class="chart-bar">
                  <div class="bar-segment focus" style="height: 65%"></div>
                  <div class="bar-segment break" style="height: 35%"></div>
               </div>
               <div class="chart-bar">
                  <div class="bar-segment focus" style="height: 75%"></div>
                  <div class="bar-segment break" style="height: 25%"></div>
               </div>
               <div class="chart-bar">
                  <div class="bar-segment focus" style="height: 58%"></div>
                  <div class="bar-segment break" style="height: 42%"></div>
               </div>
               <div class="chart-bar">
                  <div class="bar-segment focus" style="height: 90%"></div>
                  <div class="bar-segment break" style="height: 10%"></div>
               </div>
               <div class="chart-bar">
                  <div class="bar-segment focus" style="height: 82%"></div>
                  <div class="bar-segment break" style="height: 18%"></div>
               </div>
               <div class="chart-bar">
                  <div class="bar-segment focus" style="height: 45%"></div>
                  <div class="bar-segment break" style="height: 55%"></div>
               </div>
               <div class="chart-bar">
                  <div class="bar-segment focus" style="height: 40%"></div>
                  <div class="bar-segment break" style="height: 60%"></div>
               </div>
               </div>
               <div class="chart-labels">
               <div>L</div>
               <div>M</div>
               <div>X</div>
               <div>J</div>
               <div>V</div>
               <div>S</div>
               <div>D</div>
               </div>
            </div>
            <div class="chart-legend">
               <div class="legend-item">
               <span class="legend-color focus-color"></span>
               <span>Tiempo de enfoque</span>
               </div>
               <div class="legend-item">
               <span class="legend-color break-color"></span>
               <span>Descansos</span>
               </div>
            </div>
         </section>

         <!-- Consejos de estudio -->
         <section class="study-tips">
            <div class="card-header">
               <div class="tip-title">
               <i class="fas fa-lightbulb"></i>
               <h2>Consejo del día</h2>
               </div>
            </div>
            <div class="tip-content">
               <p>
               La técnica <strong>Pomodoro</strong> puede aumentar tu productividad hasta un 25%. Tus patrones de estudio
               muestran que eres más productivo en sesiones de 25 minutos.
               </p>
            </div>
         </section>
         </div>
      </div>

   {% endblock content %}